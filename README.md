# ```Raiffeisen Payment Page Sdk```

JS библиотека для работы с формой оплаты Райффайзенбанка.

#  `Документация`

* [Подключение библиотеки](#подключение-библиотеки)
    * [Подключение библиотеки в React](#подключение-библиотеки-в-React)
    * [Подключение библиотеки в html-файле](#подключение-библиотеки-в-html-файле)
* [Использование библиотеки](#использование-библиотеки)
    * [Минимальные условия для запуска](#минимальные-условия-для-запуска)
        * [Открытие формы оплаты в виде всплывающего окна](#открытие-формы-оплаты-в-виде-всплывающего-окна)
        * [Открытие формы оплаты в новой вкладке](#открытие-формы-оплаты-в-новой-вкладке)
        * [Открытие формы оплаты в той же вкладке](#открытие-формы-оплаты-в-той-же-вкладке)
    * [Расширенные параметры для запуска](#расширенные-параметры-для-запуска)
        * [Открытие в виде всплывающего окна](#открытие-в-виде-всплывающего-окна)
        * [Открытие в новой вкладке](#открытие-в-новой-вкладке)
        * [Открытие в той же вкладке](#открытие-в-той-же-вкладке)
* [Дополнительно](#дополнительно)
    * [Подключение стилей в React](#подключение-стилей-в-React)
    * [Подключение стилей в html-файле](#подключение-стилей-в-html-файле)

## `Подключение библиотеки`

#### В React

```
import PaymentPageSdk from '@raiffeisen-ecom/payment-sdk';
```

#### Скриптом

для рабочего проекта подключите минимифицированный скрипт:

```
<script src="https://e-commerce.raiffeisen.ru/pay/sdk/payment.styled.min.js"></script>
```

для расширенной работы с кодом подключите обычный скрипт:

```
<script src="https://e-commerce.raiffeisen.ru/pay/sdk/payment.styled.js"></script>
```

## `Использование библиотеки`

Работа происходит через обращения к классу `PaymentPageSdk`

### `Простые сценарии`

Обязательные парамеры:

* publicId (String) - идентификатор продавца;
* amount (Amount) - стоимость товара;

#### Форма оплаты в всплывающем окне
Для отслеживания успешности оплаты метод openPopup возвращает Promise, 
позволяющий подписаться на успешную оплату или закрытие окна.

```
const paymentPage = new PaymentPageSdk('000001680211111-80211111');

paymentPage.openPopup({amount: 10.10})
        .then(resolve => {
                        console.log(resolve, "Спасибо");
                    })
        .catch(() => {
                        console.log("Неудача");
                    });
);
```

#### Форма оплаты в новой вкладке
Для методов openWindow и replace отслеживание успешности реализуется
через необязательные параметры successUrl и failUrl.
 
```
const paymentPage = new PaymentPageSdk('000001680211111-80211111');

paymentPage.openWindow({amount: 10.10});
```

#### форма оплаты в той же вкладке:

```
const paymentPage = new PaymentPageSdk('000001680211111-80211111');

paymentPage.replace({amount: 10.10});
```

### `Расширенные сценарии:`

Обязательные параметры:

* publicId (String) - идентификатор продавца;
* amount (Amount) - стоимость товара;

Необязательные параметры:

* orderId (String) - номер заказа;
* extra (String) - любые данные, которые продавец хочет получить при вызове колбэка;
* receipt (String) - параметр, который позволяет зарегистрировать чек покупки;
* style (String) - продавцу предоставляется возможность самому изменить стилизацию страницы;
* successUrl (String) - ссылка, на которую перейдёт покупатель, в случае успешной оплаты. 
Поддерживается только для openWindow или redirect; 
* failUrl (String) - ссылка, на которую перейдёт покупатель, в случае неудачной оплаты.
Поддерживается только для openWindow или redirect;
* comment (String) - описание товара, который приобретает покупатель.

#### Пример открытия во всплывающем окне с необязательными параметрами

```
const paymentPage = new PaymentPageSdk('000001680211111-80211111');
 
paymentPage.openPopup({
                        amount: 10.10,
                        orderId: '91700',
                        extra: 'test@test.ru',                      
                        receipt: '{"check": "check"}',
                        style: {
                            "button": {
                            "backgroundColor": "#ffc800"
                        },
                        comment: 'Тирольский пирог с яблоками, грушами, ветчиной, сыром, ананасами, 50см'
                    })
        .then(resolve => {
                        console.log(resolve, "Спасибо");
                    })
        .catch(() => {
                        console.log("Неудача");
                    });
);
```

#### Пример открытия в новой вкладке с необязательными параметрами

Для методов openWindow и replace отслеживание успешности реализуется через
необязательные параметры successUrl и failUrl.

```
const paymentPage = new PaymentPageSdk('000001680211111-80211111');

paymentPage.openWindow({
                        amount: 10.10,
                        orderId: '91700',
                        extra: 'test@test.ru',                      
                        receipt: '{"check": "check"}',
                        style: '{
                            "button": {
                            "backgroundColor": "#ffc800"
                        }',
                        successUrl: 'https://www.raiffeisen.ru',
                        failUrl: 'https://online.raiffeisen.ru/#/login/main',
                        comment: 'Тирольский пирог с яблоками, грушами, ветчиной, сыром, ананасами, 50см'
                    });
```

#### Открытие в той же вкладке:
 
То же самое, что и `открытие в новой вкладке`, 
только необходимо использовать метод `paymentPage.replace()` 

## `Дополнительно`

#### Подключение стилей в React:

подключение стилей напрямую:

```
import '@raiffeisen-ecom/payment-sdk/lib-style/index.css';
```

подключение стилей, которые зашиты в js-файл:

```
import PaymentPageSdk from '@raiffeisen-ecom/payment-sdk/lib-style';
```

#### Подключение стилей в html-файле:
 
подключение стилей напрямую:

```
<link rel="stylesheet" href="https://e-commerce.raiffeisen.ru/pay/sdk/payment.min.css">
```
 
подключение стилей, которые зашиты в js-файл:

```
<script src="https://e-commerce.raiffeisen.ru/pay/sdk/payment.min.js"></script>
```
